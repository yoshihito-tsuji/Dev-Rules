# Claude Code グローバル設定

## コードレビュー

- 大きな変更（3ファイル以上 or 100行以上）完了後、code-reviewerエージェントを起動
- セキュリティ関連（auth*, *.env*）、API関連、DB関連、シェルスクリプトの変更時も必ず起動
- レビュー観点: 🔴 セキュリティ脆弱性・認証情報漏洩・データ損失 → 🟡 エラーハンドリング・パフォーマンス → 🟢 可読性・重複削減

## コミット・PRルール

- コミットメッセージは日本語、変更の意図（why）を明確に
- プレフィックス: `Add:` / `Update:` / `Fix:` / `Refactor:` / `Docs:` / `Security:`
- PR: Summary（3-5行）、Test plan、Security considerations を含める

## コード品質基準

- 認証情報はハードコードしない（環境変数・設定ファイル使用）
- ユーザー入力は必ずバリデーション・サニタイズ、API通信はHTTPS
- 外部API呼び出しには必ずエラーハンドリング、エラーメッセージは具体的に
- 関数は単一責任、変数名・関数名は意図が明確に

## 三者間協働ルール

### 開発方法論: Dev-Rules

全プロジェクト共通の三者協働開発方法論。各プロジェクトのREADME.mdに参照あり。
- **GitHub**: https://github.com/yoshihito-tsuji/Dev-Rules
- **ローカル**: 各プロジェクトの `../Dev-Rules/` に配置
- **Claude Code Best Practice**: `../Dev-Rules/claude-code/README.md`

### Claude Code Best Practice（要点）

- CLAUDE.mdは150行以下を目標に簡潔に保つ
- 複雑なタスクはプランモードから開始する
- サブタスクはコンテキスト使用率50%以内で完了できる単位に分割
- コンテキスト使用率50%で手動 /compact を実施
- タスク完了後すぐにコミットする
- コマンド→エージェント→スキルの3層アーキテクチャを活用

### 役割分担・コミュニケーション

- **Yoshihitoさん**: プロダクトオーナー、最終意思決定者
- **Codex**: アーキテクト、設計者、技術方針策定
- **Claude Code**: 実装エンジニア、コードレビュー実施
- **From/To記法を使用**（例: `From: Claude Code, To: Yoshihitoさん`）
- 意思決定優先順位: Yoshihitoさんの意図 > Codexの設計方針 > 技術的ベストプラクティス
- レビュー完了後は必ずYoshihitoさんに報告、重要な判断は実装前に確認

## UI/UX実装指針

UI実装時は以下を守ること。背景知識は `Dev-Rules/setup/ux-design-principles.md` を参照。

- **認知負荷を最小化**し、必要な場面のみ詳細を開示（段階的開示）
- **デフォルト値は慎重に設定**（デフォルト効果を考慮）
- **エラーメッセージは損失回避を意識**し、ポジティブな代替案を提示
- **応答は0.4秒以内**、超える場合は進捗表示を実装
- **重要なアクション（削除等）には確認ダイアログ**を設ける
- **ボタン・リンクは重要なものを最初か最後に配置**（系列位置効果）
- **視覚的階層を明確に**（サイズ・色・配置で優先順位を示す）
- **ピーク（良い体験）とエンド（快い完了）を意識**したフロー設計
